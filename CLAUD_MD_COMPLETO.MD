
    responsable VARCHAR(255),
    proyecto VARCHAR(255), -- Acepta "CONVENIO-FINANCIAMIENTO" o cualquier otro nombre
    total_hectareas DECIMAL(10,4),
    total_m2 BIGINT,
    cantidad_folios INT,
    observaciones TEXT,
    archivo VARCHAR(255),
    tubo VARCHAR(255),
    tela VARCHAR(255), 
    archivo_digital VARCHAR(255),
    created_by BIGINT UNSIGNED, -- FK a users
    created_at TIMESTAMP NULL,
    updated_at TIMESTAMP NULL,
    
    FOREIGN KEY (created_by) REFERENCES users(id)
);
TABLA 3: planos_folios
sqlCREATE TABLE planos_folios (
    id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    plano_id BIGINT UNSIGNED NOT NULL,
    folio VARCHAR(50), -- NO unique, puede repetirse en diferentes planos
    solicitante VARCHAR(255),
    apellido_paterno VARCHAR(255),
    apellido_materno VARCHAR(255),
    tipo_inmueble ENUM('HIJUELA','SITIO'),
    numero_inmueble INT,
    hectareas DECIMAL(10,4), -- Solo para HIJUELA (NULL para sitios)
    m2 BIGINT, -- Para ambos tipos
    is_from_matrix BOOLEAN DEFAULT true, -- true=Matrix, false=Manual
    matrix_folio VARCHAR(50), -- Referencia original Matrix
    created_at TIMESTAMP NULL,
    updated_at TIMESTAMP NULL,
    
    FOREIGN KEY (plano_id) REFERENCES planos(id) ON DELETE CASCADE
);
TABLA 4: matrix_import
sqlCREATE TABLE matrix_import (
    id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    folio VARCHAR(50), -- NO unique, puede repetirse
    tipo_inmueble VARCHAR(100),
    provincia VARCHAR(100), 
    comuna VARCHAR(100),
    nombres VARCHAR(255),
    apellido_paterno VARCHAR(255),
    apellido_materno VARCHAR(255),
    responsable VARCHAR(255),
    convenio_financiamiento VARCHAR(255), -- Nombre original del campo Matrix
    batch_import VARCHAR(50), -- MATRIX-2025-09
    created_at TIMESTAMP NULL,
    updated_at TIMESTAMP NULL,
    
    INDEX idx_folio (folio),
    INDEX idx_batch (batch_import)
);
TABLA 5: session_control
sqlCREATE TABLE session_control (
    id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT UNSIGNED NOT NULL,
    session_id VARCHAR(255) NOT NULL,
    has_control BOOLEAN DEFAULT false,
    requested_at TIMESTAMP NULL,
    granted_at TIMESTAMP NULL,
    released_at TIMESTAMP NULL,
    is_active BOOLEAN DEFAULT true,
    created_at TIMESTAMP NULL,
    updated_at TIMESTAMP NULL,
    
    FOREIGN KEY (user_id) REFERENCES users(id),
    INDEX idx_control (has_control, is_active),
    INDEX idx_user_session (user_id, session_id)
);
TABLA 6: comunas_biobio
sqlCREATE TABLE comunas_biobio (
    codigo CHAR(3) PRIMARY KEY, -- 101, 102, 301, 201, 401
    nombre VARCHAR(100) NOT NULL,
    provincia VARCHAR(100) NOT NULL,
    created_at TIMESTAMP NULL,
    updated_at TIMESTAMP NULL
);

TAB 1: TABLA GENERAL - ESPECIFICACIÃ“N COMPLETA
CONTEXTO:
TAB principal donde usuarios consultan y gestionan planos existentes.
INTERFAZ TAB 1:
HEADER:
LIBRO DE PLANOS TOPOGRÃFICOS          [Mostrar/Ocultar Filtros]
Mostrando 1-25 de 1,245 registros | Filtros activos: 2
[Buscar global] [Mostrar: 25] [Excel] [PDF] [Print]
FILTROS AVANZADOS (3 FILAS):
FILTROS AVANZADOS                                    [Ocultar]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ROW 1: [Comuna] [AÃ±o] [Mes] [Responsable] [Proyecto]           â”‚
â”‚ ROW 2: [Folio] [Solicitante] [Ap.Pat] [Ap.Mat]                 â”‚  
â”‚ ROW 3: HectÃ¡reas: [Min] a [Max]  MÂ²: [Min] a [Max]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
[Limpiar] [Aplicar]
DATATABLE PRINCIPAL:
COLUMNAS (15 total):

[EDITAR] - Solo usuarios con rol 'registro'
[REASIGNAR] - Solo usuarios con rol 'registro'
NÂ° PLANO - 0830329271SR
FOLIOS - Formato especial segÃºn cantidad
SOLICITANTE - Nombre o "MÃšLTIPLES"
APELLIDO PATERNO - Real o "-"
APELLIDO MATERNO - Real o "-"
COMUNA - Texto
HECTÃREAS - NÃºmero o "-"
MÂ² - NÃºmero
MES - Texto
AÃ‘O - NÃºmero
RESPONSABLE - Texto
PROYECTO - Texto
[+/-] - Expandir/Colapsar

FORMATO COLUMNA FOLIOS (CRÃTICO):
php// LÃ“GICA DISPLAY:
// - 1 folio:     "123456"
// - 2 folios:    "123456, 789012"  
// - 3+ folios:   "123456, 789012 +4 mÃ¡s"

function getDisplayFolios($folios) {
    $count = $folios->count();
    if ($count <= 2) {
        return $folios->pluck('folio')->join(', ');
    }
    $first_two = $folios->take(2)->pluck('folio')->join(', ');
    return $first_two . " +{$count-2} mÃ¡s";
}
FILAS EXPANDIBLES - REPRESENTACIÃ“N VISUAL:
EJEMPLO 1: Plano con 1 folio
COLAPSADO:
| [âœï¸] | [ğŸ”„] | 0830329271SR | 123456 | JUAN | PEREZ | GONZALEZ | CONCEPCIÃ“N | 2,50 | 25000 | DIC | 2025 | CARLOS | CONVENIO | [+] |
EXPANDIDO:
| [âœï¸] | [ğŸ”„] | 0830329271SR | 123456 | JUAN | PEREZ | GONZALEZ | CONCEPCIÃ“N | 2,50 | 25000 | DIC | 2025 | CARLOS | CONVENIO | [-] |
â”‚      â”‚      â”‚   â”” Folio    â”‚ 123456 â”‚ JUAN â”‚ PEREZ â”‚ GONZALEZ â”‚           â”‚ 2,50 â”‚ 25000 â”‚     â”‚      â”‚        â”‚          â”‚     â”‚
EJEMPLO 2: Plano con 6 folios
COLAPSADO:
| [âœï¸] | [ğŸ”„] | 0830329273CR | 111111, 222222 +4 mÃ¡s | MÃšLTIPLES | - | - | TALCAHUANO | 12,30 | 123000 | FEB | 2025 | ANA | FISCAL | [+] |
EXPANDIDO:
| [âœï¸] | [ğŸ”„] | 0830329273CR | 111111, 222222 +4 mÃ¡s | MÃšLTIPLES | - | - | TALCAHUANO | 12,30 | 123000 | FEB | 2025 | ANA | FISCAL | [-] |
â”‚      â”‚      â”‚   â”” Folio    â”‚ 111111                 â”‚ JUAN     â”‚PEREZ â”‚GONZALEZâ”‚           â”‚ 2,50  â”‚ 25000 â”‚     â”‚      â”‚       â”‚          â”‚     â”‚
â”‚      â”‚      â”‚   â”” Folio    â”‚ 222222                 â”‚ MARIA    â”‚LOPEZ â”‚RAMIREZ â”‚           â”‚ 1,75  â”‚ 17500 â”‚     â”‚      â”‚       â”‚          â”‚     â”‚
â”‚      â”‚      â”‚   â”” Folio    â”‚ 333333                 â”‚ PEDRO    â”‚SILVA â”‚MORALES â”‚           â”‚ 2,25  â”‚ 22500 â”‚     â”‚      â”‚       â”‚          â”‚     â”‚
â”‚      â”‚      â”‚   â”” Folio    â”‚ 444444                 â”‚ ANA      â”‚ROJAS â”‚CASTRO  â”‚           â”‚ 1,50  â”‚ 15000 â”‚     â”‚      â”‚       â”‚          â”‚     â”‚
â”‚      â”‚      â”‚   â”” Folio    â”‚ 555555                 â”‚ LUIS     â”‚TORRESâ”‚HERRERA â”‚           â”‚ 2,75  â”‚ 27500 â”‚     â”‚      â”‚       â”‚          â”‚     â”‚
â”‚      â”‚      â”‚   â”” Folio    â”‚ 666666                 â”‚ CARMEN   â”‚ VEGA â”‚ MORENO â”‚           â”‚ 2,00  â”‚ 20000 â”‚     â”‚      â”‚       â”‚          â”‚     â”‚
IMPLEMENTACIÃ“N TÃ‰CNICA DATATABLE:
CONFIGURACIÃ“N DATATABLE:
javascript$('#planosTable').DataTable({
    "pageLength": 25,
    "lengthMenu": [[10, 25, 50, 100, -1], [10, 25, 50, 100, "Todos"]],
    "searching": true,
    "ordering": true,
    "info": true,
    "responsive": {
        "details": {
            "type": "column",
            "target": -1
        }
    },
    "columnDefs": [{
        "className": "dtr-control",
        "orderable": false,
        "targets": -1
    }],
    "buttons": [
        {
            "extend": "excel",
            "text": "Excel",
            "exportOptions": {
                "columns": ":visible"
            }
        },
        "pdf", "print"
    ]
});
FILTROS AVANZADOS POR COLUMNA:
javascript// Filtros especÃ­ficos
- Comuna: Select con todas las comunas disponibles
- AÃ±o: Select con aÃ±os Ãºnicos de planos
- Mes: Select con meses disponibles  
- Responsable: Select con responsables Ãºnicos
- Proyecto: Select con proyectos Ãºnicos
- Folio: Input texto para bÃºsqueda exacta
- Solicitante: Input texto para bÃºsqueda parcial
- Apellidos: Input texto para bÃºsqueda parcial
- HectÃ¡reas: Range slider (min-max)
- MÂ²: Range slider (min-max)
CONSULTA OPTIMIZADA:
php$query = Plano::select([
    'planos.*',
    DB::raw('COUNT(planos_folios.id) as cantidad_folios'),
    DB::raw('SUM(planos_folios.hectareas) as total_hectareas'),
    DB::raw('SUM(planos_folios.m2) as total_m2'),
    DB::raw('GROUP_CONCAT(planos_folios.folio ORDER BY planos_folios.id LIMIT 2) as primeros_folios')
])
->leftJoin('planos_folios', 'planos.id', '=', 'planos_folios.plano_id')
->groupBy('planos.id');
ESTRUCTURA HTML EXPANDIBLE:
php// Filas hijo para expansiÃ³n
foreach($plano->folios as $folio) {
    echo "<tr class='child-row'>";
    echo "<td></td><td></td>"; // Columnas vacÃ­as EDITAR/REASIGNAR
    echo "<td>â”” Folio</td>";
    echo "<td>{$folio->folio}</td>";
    echo "<td>{$folio->solicitante}</td>";
    echo "<td>{$folio->apellido_paterno}</td>";
    echo "<td>{$folio->apellido_materno}</td>";
    echo "<td></td>"; // Comuna vacÃ­a en detalle
    echo "<td>{$folio->hectareas}</td>";
    echo "<td>{$folio->m2}</td>";
    echo "<td></td><td></td><td></td><td></td><td></td>"; // Resto vacÃ­o
    echo "</tr>";
}
CONTROL DE ACCESO:

CONSULTA: Ve todo, no puede editar
REGISTRO: Ve todo + columnas EDITAR/REASIGNAR + puede modificar


TAB 2: IMPORTACIÃ“N MASIVA - ESPECIFICACIÃ“N COMPLETA
CONTEXTO:
Tab para alimentar sistema con dos tipos de archivos diferentes.
INTERFAZ TAB 2 - DOS SECCIONES:
SECCIÃ“N A: MATRIX IMPORTER (Mensual)
ACTUALIZACIÃ“N MATRIX MENSUAL
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Archivo: MATRIX-2025-09.xlsx                               â”‚
â”‚ [Seleccionar archivo] [Vista previa] [Importar]            â”‚
â”‚                                                             â”‚
â”‚ COLUMNAS EXTRAÃDAS: Solo 8 de todas las disponibles        â”‚
â”‚ Ãšltima importaciÃ³n: 15/08/2025 - 1,234 registros          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
SECCIÃ“N B: HISTORICAL IMPORTER (Una vez)
IMPORTACIÃ“N PLANOS HISTÃ“RICOS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Archivo: PLANOS-HISTORICOS.xlsx                            â”‚
â”‚ [Seleccionar archivo] [Vista previa] [Importar]            â”‚
â”‚                                                             â”‚
â”‚ ATENCIÃ“N: Esta importaciÃ³n se realiza una sola vez         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
MATRIX IMPORTER:

Formato: Excel (.xlsx)
Frecuencia: Mensual
ExtracciÃ³n automÃ¡tica de 8 columnas:

TIPO INMUEBLE
Comuna
NOMBRES
APELLIDO PATERNO
APELLIDO MATERNO
FOLIOS-EXPEDIENTES
RESPONSABLE
CONVENIO-FINANCIAMIENTO


Destino: tabla matrix_import
Duplicados: ValidaciÃ³n inteligente + opciÃ³n actualizar/mantener

HISTORICAL IMPORTER:

Formato: Excel (.xlsx)
Frecuencia: Una sola vez
21 columnas del sistema anterior
Destino: tablas planos + planos_folios
ValidaciÃ³n: NÃºmeros de plano Ãºnicos, folios pueden repetirse


TAB 3: AGREGAR PLANOS - ESPECIFICACIÃ“N COMPLETA
CONTROL DE SESIONES (CRÃTICO):
Solo UN usuario puede crear nÃºmeros correlativos simultÃ¡neamente.
CONTROL DE NUMERACIÃ“N CORRELATIVA
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Estado: TIENES CONTROL - Puedes crear nuevos nÃºmeros       â”‚
â”‚ Ãšltimo correlativo: 29271                                   â”‚
â”‚ PrÃ³ximo nÃºmero: 0830329272SU                               â”‚
â”‚ [Liberar control]                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
SELECTOR INICIAL - TIPO DE PLANO:
TIPO DE PLANO A CREAR
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â—‹ PLANO MATRIX - Folios desde base de datos Matrix         â”‚
â”‚ â—‹ PLANO MANUAL - Ingreso libre (fiscales y otros)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
PLANO MATRIX - OPCIONES DE CANTIDAD:
CANTIDAD DE FOLIOS (PLANO MATRIX)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â—‹ 1 FOLIO - Formulario simple                              â”‚
â”‚ â—‹ 2-10 FOLIOS - Formulario mÃºltiple                        â”‚  
â”‚ â—‹ FOLIOS MASIVOS (11-150) - ImportaciÃ³n masiva             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
OPCIÃ“N 1: 1 FOLIO

Input Ãºnico para folio
Auto-completado inmediato desde Matrix
ValidaciÃ³n existencia en BD

OPCIÃ“N 2: 2-10 FOLIOS

10 inputs disponibles
BÃºsqueda individual por folio
Filas aparecen conforme se encuentran

OPCIÃ“N 3: FOLIOS MASIVOS

Textarea para pegar lista masiva
DetecciÃ³n automÃ¡tica de folios
Listado encontrados vs no encontrados
OpciÃ³n agregar folios manuales

PLANO MANUAL:

Sin validaciÃ³n Matrix obligatoria
Campos editables manualmente
Para casos fiscales: "FISCO DE CHILE" sin apellidos

TIPOS DE PLANO:
DespuÃ©s de seleccionar Matrix/Manual, elegir:

Tipo: â—‹ Saneamiento â—‹ Fiscal
UbicaciÃ³n: â—‹ Urbano â—‹ Rural

Combinaciones:

Saneamiento + Urbano = SU
Saneamiento + Rural = SR
Fiscal + Urbano = CU
Fiscal + Rural = CR

CAMPOS POR UBICACIÃ“N:

Rural: Hijuela + HectÃ¡reas + MÂ²
Urbano: Solo MÂ²

NUMERACIÃ“N AUTOMÃTICA:
php// 08 + codigo_comuna + correlativo + tipo + ubicacion
$numero = '08' . $codigo_comuna . $correlativo . $tipo_ubicacion;
// Ejemplo: 0830329272SU

TAB 4: REPORTES - PENDIENTE
Definir despuÃ©s de funcionalidades core implementadas.

SISTEMA DE CONTROL DE SESIONES
OBJETIVO:
Solo un usuario puede crear nÃºmeros correlativos manteniendo secuencia.
ESTADOS:

CONTROL ACTIVO: Usuario puede crear nÃºmeros
SIN CONTROL: Debe solicitar acceso
SOLICITUD PENDIENTE: Esperando aprobaciÃ³n

NOTIFICACIONES:

Tiempo real con WebSockets
Solicitudes y respuestas instantÃ¡neas
Estado actualizado automÃ¡ticamente


ARQUITECTURA MODULAR
LÃMITES POR ARCHIVO:

Controllers: mÃ¡x 300 lÃ­neas
Models: mÃ¡x 200 lÃ­neas
Blade templates: mÃ¡x 250 lÃ­neas
JavaScript: mÃ¡x 300 lÃ­neas
CSS: mÃ¡x 200 lÃ­neas

ESTRUCTURA RECOMENDADA:
Controllers (app/Http/Controllers/Admin/):
PlanoController.php              # CRUD bÃ¡sico (300 lÃ­neas max)
PlanoMasivoController.php        # Procesamiento masivo (250 lÃ­neas)
PlanoValidacionController.php    # Validaciones especÃ­ficas (200 lÃ­neas)
PlanoImportacionController.php   # Tab 2 importadores (250 lÃ­neas)
SessionControlController.php     # Control de sesiones (200 lÃ­neas)
Models (app/Models/):
User.php                         # Usuario + roles (150 lÃ­neas)
Plano.php                        # Modelo principal (200 lÃ­neas)
PlanoFolio.php                   # Detalle folios (150 lÃ­neas)
MatrixImport.php                 # Auto-completado (100 lÃ­neas)
SessionControl.php               # Control sesiones (100 lÃ­neas)
ComunaBiobio.php                 # CatÃ¡logo (80 lÃ­neas)

Traits/PlanoValidationTrait.php  # Validaciones (150 lÃ­neas)
Traits/PlanoNumberTrait.php      # NumeraciÃ³n (100 lÃ­neas)
Views (resources/views/admin/planos/):
# 4 tabs principales
index.blade.php                  # Tab 1 - Tabla (250 lÃ­neas)
importacion.blade.php            # Tab 2 - ImportaciÃ³n (250 lÃ­neas)
agregar.blade.php                # Tab 3 - Agregar (200 lÃ­neas)
reportes.blade.php               # Tab 4 - Reportes (150 lÃ­neas)

# Formularios especÃ­ficos
create-matrix.blade.php          # Planos Matrix (200 lÃ­neas)
create-manual.blade.php          # Planos manuales (150 lÃ­neas)
create-masivo.blade.php          # Interface masiva (250 lÃ­neas)

partials/
â”œâ”€â”€ tab-navigation.blade.php     # NavegaciÃ³n tabs (60 lÃ­neas)
â”œâ”€â”€ session-control.blade.php    # Control sesiones (100 lÃ­neas)
â”œâ”€â”€ folio-search.blade.php       # BÃºsqueda individual (80 lÃ­neas)  
â”œâ”€â”€ bulk-input.blade.php         # Input masivo (100 lÃ­neas)
â””â”€â”€ modals/
    â”œâ”€â”€ edit-plano.blade.php     # EdiciÃ³n (120 lÃ­neas)
    â”œâ”€â”€ reasignar.blade.php      # Reasignar nÃºmero (100 lÃ­neas)
    â””â”€â”€ session-request.blade.php # Solicitar control (80 lÃ­neas)
JavaScript (resources/js/admin/planos/):
plano-tabs.js                    # NavegaciÃ³n tabs (100 lÃ­neas)
plano-tabla.js                   # Tab 1 DataTable (250 lÃ­neas)
plano-importacion.js             # Tab 2 importadores (300 lÃ­neas)
plano-agregar.js                 # Tab 3 formularios (300 lÃ­neas)
session-control.js               # Control sesiones (200 lÃ­neas)

components/
â”œâ”€â”€ folio-searcher.js            # BÃºsqueda reutilizable (150 lÃ­neas)
â”œâ”€â”€ bulk-processor.js            # Procesador masivo (200 lÃ­neas)
â”œâ”€â”€ matrix-autocomplete.js       # Auto-completado (120 lÃ­neas)
â””â”€â”€ validation-display.js        # Mostrar errores (100 lÃ­neas)

PROTECCIÃ“N DE BASE DE DATOS

NUNCA ejecutar sin confirmaciÃ³n: migrate:fresh, migrate:reset, migrate:refresh, db:wipe
SIEMPRE preguntar antes de comandos destructivos
RECORDAR hacer backup antes de migraciones


PROCESO DE DESARROLLO
FASE 2: BASE DE DATOS (ACTUAL)

Crear migraciones con estructura definida
Ejecutar migraciones y verificar
Crear seeders para comunas y usuarios test

FASE 3: BACKEND MODULAR

Modelos con relaciones
Controllers separados por funcionalidad
Middleware para control de sesiones
Validaciones y traits

FASE 4: FRONTEND MODULAR

Layout AdminLTE + 4 tabs
Tab 1: DataTable con filtros
Tab 2: Importadores duales
Tab 3: Formularios Matrix/Manual

FASE 5: INTEGRACIÃ“N

Sistema control sesiones completo
Auto-completado Matrix funcionando
Validaciones tiempo real
NumeraciÃ³n automÃ¡tica


COMANDOS ÃšTILES
bash# Servidor
cd C:\xampp\htdocs\libro_planos
php artisan serve

# Migraciones
php artisan migrate
php artisan migrate:rollback
php artisan db:seed

# Cache
php artisan config:clear
php artisan cache:clear

DECISIONES TÃ‰CNICAS CONFIRMADAS

Blade + AJAX (no Vue.js)
NumeraciÃ³n: 0830329272SU (S=Saneamiento, C=Fiscal)
Estructura 6 tablas optimizada
Control sesiones Ãºnico
Tipos: SR/SU (saneamiento) vs CR/CU (fiscal)
Campos por ubicaciÃ³n: Rural (hijuela+ha+mÂ²) vs Urbano (mÂ²)
Casos especiales: FISCO DE CHILE sin apellidos
Folios 1-150 por plano (mayorÃ­a 1-10)
DataTable expandible con representaciÃ³n visual especÃ­fica

SISTEMA COMPLETAMENTE ESPECIFICADO - LISTO PARA IMPLEMENTACIÃ“N